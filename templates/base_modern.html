<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Dashboard Auditoria FB{% endblock %}</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Modern Dashboard CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-dashboard.css') }}">
    
    <!-- Custom Styles -->
    <style>
        /* Glassmorphism Effects */
        .glass {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        /* Glow Effects */
        .glow-primary {
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
        }
        
        .glow-success {
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }
        
        /* Grid System */
        .dashboard-grid {
            display: grid;
            gap: 24px;
            grid-template-columns: repeat(12, 1fr);
        }
        
        .col-span-3 { grid-column: span 3; }
        .col-span-4 { grid-column: span 4; }
        .col-span-6 { grid-column: span 6; }
        .col-span-8 { grid-column: span 8; }
        .col-span-12 { grid-column: span 12; }
        
        @media (max-width: 1200px) {
            .col-span-3, .col-span-4 { grid-column: span 6; }
            .col-span-8 { grid-column: span 12; }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid { grid-template-columns: 1fr; }
            [class*="col-span"] { grid-column: span 1; }
        }
    </style>
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Modern Navbar -->
    <nav class="navbar-modern">
        <div class="container-fluid">
            <a href="{{ url_for('dashboard') }}" class="brand">
                <img src="{{ url_for('static', filename='images/logo/logofb_white.png') }}" alt="Logo" class="brand-logo">
                <span class="brand-text">Auditoria FB</span>
            </a>
            
            <div style="margin-left: auto; display: flex; align-items: center; gap: 24px;">
                <!-- Notifications -->
                <button class="btn-modern ghost" style="width: 40px; height: 40px; padding: 0;">
                    <i class="fas fa-bell"></i>
                </button>
                
                <!-- User Profile -->
                {% if current_user.is_authenticated %}
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="text-align: right;">
                        <div style="font-size: 0.875rem; font-weight: 600;">{{ current_user.nome }}</div>
                        <div style="font-size: 0.75rem; opacity: 0.6;">{{ current_user.perfil|title }}</div>
                    </div>
                    <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--info)); display: flex; align-items: center; justify-content: center; font-weight: 700;">
                        {{ current_user.nome[0]|upper }}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </nav>
    
    {% if current_user.is_authenticated and show_sidebar is not defined or show_sidebar %}
    <!-- Modern Sidebar -->
    <aside class="sidebar-modern" id="sidebar">
        <nav>
            <!-- Main Navigation -->
            <div class="nav-item">
                <a href="{{ url_for('dashboard') }}" class="nav-link {% if request.endpoint == 'dashboard' %}active{% endif %}">
                    <span class="nav-icon"><i class="fas fa-home"></i></span>
                    <span class="nav-text">Dashboard</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="{{ url_for('indicators') }}" class="nav-link {% if request.endpoint == 'indicators' %}active{% endif %}">
                    <span class="nav-icon"><i class="fas fa-chart-line"></i></span>
                    <span class="nav-text">Indicadores</span>
                </a>
            </div>
            
            <!-- Admin Section -->
            {% if current_user.perfil in ['admin', 'gestor'] %}
            <div class="nav-footer">
                <div class="nav-item">
                    <a href="{{ url_for('import_data') }}" class="nav-link {% if request.endpoint == 'import_data' %}active{% endif %}">
                        <span class="nav-icon"><i class="fas fa-upload"></i></span>
                        <span class="nav-text">Importar</span>
                    </a>
                </div>
                {% if current_user.perfil == 'admin' %}
                <div class="nav-item">
                    <a href="{{ url_for('settings') }}" class="nav-link {% if request.endpoint == 'settings' %}active{% endif %}">
                        <span class="nav-icon"><i class="fas fa-cog"></i></span>
                        <span class="nav-text">Configurações</span>
                    </a>
                </div>
                {% endif %}
            </div>
            {% endif %}
        </nav>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>
    {% else %}
    <!-- Full Width Content -->
    <main style="margin-top: 60px;">
        {% block fullwidth_content %}{% endblock %}
    </main>
    {% endif %}
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/formatters.js') }}"></script>
    
    <!-- Sparkline -->
    <script src="https://cdn.jsdelivr.net/npm/sparkline@0.1.2/dist/sparkline.min.js"></script>
    
    <script>
        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            // Animate cards on load
            document.querySelectorAll('.card-modern').forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease-out';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>